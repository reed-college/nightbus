<!doctype html>

<head>
	<title>Nightbus | Add Users </title>
	<link rel="stylesheet" href="../static/css/normalize.css">
	<link rel="stylesheet" href="../static/css/style.css">
	<meta name="viewport" content="initial-scale=1, width=device-width">
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
	<script src="http://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.js"></script>
	<script src="http://ajax.microsoft.com/ajax/jquery.validate/1.7/additional-methods.js"></script>
	<style>
	@media screen and (max-width: 768px) {
		.wrapper {
			width: auto;
		}
		.content {
			max-width: 100%;
			/*background-color: brown;*/
			max-height: 50%;
		}
		.form-container {
			width: inherit;
			margin: 0 15px;
		}
		#messageBox {

		}
	}
	</style>
</head>

<body>
	<div class="wrapper">
		<div class="header">
			<h1>Add Users</h1>
		</div>
		<div class="content">
			<form action="/register" method="post">
				<ul class="form-container" >
					<li>
						{% with messages = get_flashed_messages() %}
							{% if messages %}
								{% for message in messages %} {{ message }}
								{% endfor %}
							{% endif %}
						{% endwith %}
					</li>
					<li>
						<input type="text" placeholder="first name" name="firstname" required><br>
					</li>
					<li>
						<input type="text" placeholder="last name" name="lastname" required><br>
					</li>
					<li>
						<input type="text" placeholder="username" name="username" required><br>
					</li>
					<li>
						<input type="email" placeholder="email" name="email" required><br>
					</li>
					<li>
						<input type="password" placeholder="password" name="password" required><br>
					</li>
					<li id="messageBox"></li>
					<li>
						<input class="submit-button" name="submit" type="submit" value="Save!">
					</li>
				</ul>

			</form>
		</div>
		<script>
			$(function() {
				$('form').validate({

					// place error messages in the error box
					errorPlacement: function(error, element) {
						error.appendTo($('#messageBox'));
						$('#messageBox').css({
							'display': 'block',
							'position': 'absolute',
							'width': '100%',
							'height': '33%',
							'left': '110%',
							'top': '55%',
							'text-align': 'left'
						});

						//turn off auto validate whilst typing
						element.keyup( function() {
	 					 $('#messageBox').empty();
	 				 });
					},

					//Specify validation rules
					rules: {
						firstname: "required",
						lastname: "required",
						username: {
							required: true,
							// check if username already exists.
							remote: {
								url: 'username_exists',
								type: 'post',
								data: {
									username: function() {
										return $("input[name=username]").val()
									}
								}
							}
						},
						email: {
							required: true,
							email: true, // Specify that email should be validated by the built-in "email" rule
							remote: {
								url: 'email_exists',
								type: 'post',
								data: {
									email: function() {
										return $('input[name=email]').val()
									}
								}
							}
						},
						password: {
							required: true,
							minlength: 5
						}
					},

					// specify validation error messages
					messages: {
						firstname: "<br>" + "Please enter your first name",
						lastname: "<br>" + "Please enter your lastname",
						username: {
							required: "<br>" + "Please enter your username",
							remote: jQuery.validator.format("<br>" + "Username is already taken")
						},
						password: {
							required: "<br>"+ "Please provide a password" ,
							minlength: "<br>" + "Your password must be at least 5 characters long"
						},
						email: {
							required: "<br>" + "Please enter an email address",
							email: "<br>"+ "Please enter a valid email address",
							remote: jQuery.validator.format("<br>" +  "Email is already registered")
						}
					},

					submitHandler: function(form) {
						form.submit();
					}
				});
			});
		</script>
	</div>
</body>

</html>
